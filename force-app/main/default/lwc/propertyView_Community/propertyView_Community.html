<template>
    <template if:true={spinnerdatatable}>
        <c-spinner-component></c-spinner-component>
    </template>
    <div class="container">
        <div if:false={errorMessage} class="buttons">
            <div class="backbtn" onclick={moveToPropertyPage}>
                <svg width="30" height="20" viewBox="0 0 30 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M30 10C30 10.3788 29.8025 10.7421 29.4509 11.01C29.0993 11.2778 28.6224 11.4283 28.1252 11.4283H6.40389L14.4542 17.5586C14.6285 17.6914 14.7668 17.8491 14.8612 18.0226C14.9555 18.1961 15.004 18.3821 15.004 18.5699C15.004 18.7577 14.9555 18.9437 14.8612 19.1172C14.7668 19.2907 14.6285 19.4483 14.4542 19.5811C14.2799 19.7139 14.073 19.8193 13.8452 19.8911C13.6175 19.963 13.3734 20 13.1269 20C12.8804 20 12.6363 19.963 12.4085 19.8911C12.1808 19.8193 11.9738 19.7139 11.7995 19.5811L0.55079 11.0112C0.376197 10.8786 0.237677 10.721 0.143163 10.5474C0.0486494 10.3739 0 10.1879 0 10C0 9.81213 0.0486494 9.6261 0.143163 9.45257C0.237677 9.27905 0.376197 9.12143 0.55079 8.98875L11.7995 0.418872C12.1516 0.150673 12.629 0 13.1269 0C13.6247 0 14.1022 0.150673 14.4542 0.418872C14.8063 0.687071 15.004 1.05083 15.004 1.43012C15.004 1.80941 14.8063 2.17317 14.4542 2.44137L6.40389 8.57169H28.1252C28.6224 8.57169 29.0993 8.72217 29.4509 8.99003C29.8025 9.25789 30 9.62119 30 10Z" fill="black"/>
                </svg>                                            
            </div>
        </div>
        <div class="box1">
            <div class="main_detail_box">
                <div class="carousel">
                    <img src={propertyView}/>
                </div>
                <div class="listing_property_details">
                    <div class="listing_Featureproperty_details"><p>Featured Property</p></div>
                    <div class="box2">
                        <template for:each={propertyData} for:item="info">
                            <div key={info.Id} class="upper_header_data">
                                <div class="info_Name">
                                    <div>
                                        <h1><b>{info.Name}</b></h1>
                                        <p>{info.City__c},{info.State__c},{info.Postal_Code__c}</p>
                                    </div>
                                    <div class="vendor_info">
                                        <lightning-avatar slot="media" variant="circle" size="large"
                                            src="https://www.lightningdesignsystem.com/assets/images/avatar1.jpg"
                                            fallback-icon-name="standard:avatar" alternative-text="Bruce Wayne"></lightning-avatar>
                                        <p class="vendorName"><b>Sandeep S.</b><br /><span class="vendorType">Partner</span></p>
                                    </div>
                                </div>
                                <div class="property_v_span">
                                    <div class="property_v">
                                        <img src={plvimg1} alt="bed">
                                        &nbsp;&nbsp; <p>{info.Number_of_Bedrooms__c} Beds</p>
                                    </div>
                                    <div class="property_v">
                                        <img src={plvimg2} alt="bath">
                                        &nbsp;&nbsp; <p>{info.Number_of_Bathrooms__c} Baths</p>
                                    </div>
                                    <div class="property_v">
                                        <img src={plvimg3} alt="balcony">
                                        &nbsp;&nbsp; <p>{info.Number_of_Bedrooms__c} Balconies</p>
                                    </div>
                                    <div class="property_v">
                                        <img src={plvimg4} alt="funished">
                                        &nbsp;&nbsp; <p>Semi furnished</p>
                                    </div>
                                </div>
                                <div class="info_Price">
                                    <svg width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M11 2V0H0V2H3.5C4.802 2 5.901 2.838 6.315 4H0V6H6.315C6.10973 6.58323 5.72892 7.08861 5.22488 7.44672C4.72085 7.80483 4.1183 7.9981 3.5 8H0V10.414L5.586 16H8.414L2.414 10H3.5C4.65196 9.99846 5.76816 9.59975 6.66039 8.8711C7.55263 8.14245 8.16632 7.12842 8.398 6H11V4H8.398C8.24471 3.2722 7.92884 2.58848 7.474 2H11Z" fill="#0176D3"/>
                                    </svg>                                        
                                    <p class="info_Price_value">{info.Listing_Price__c}</p>
                                </div>
                                <div class="details_1">
                                    <div class="details_class">
                                        <p class="details_field">Carpet Area</p>
                                        <p class="details_value">1015 sqft</p>
                                        <p class="details_value1">
                                            <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M0 0V0.909091H1.5C2.13862 0.909091 2.97787 1.38182 3.26962 2.27273H0V3.18182H3.36337C3.2475 4.36818 2.23988 5 1.5 5H0V6.12227L3.84375 10H5.01562L0.96075 5.90909H1.5C2.71275 5.90909 4.0035 4.82273 4.11337 3.18182H6V2.27273H4.0545C3.94088 1.73455 3.6975 1.275 3.375 0.909091H6V0H0Z" fill="black"/>
                                            </svg> 8025/sqft
                                        </p>
                                    </div>
                                    <div class="details_class">
                                        <p class="details_field">Transaction Type</p>
                                        <p class="details_value">Resale</p>
                                    </div>
                                    <div class="details_class">
                                        <p class="details_field">Status</p>
                                        <p class="details_value">Ready to Move</p>
                                    </div>
                                <!-- </div> -->
                                <!-- <div class="details_1"> -->
                                    <div class="details_class">
                                        <p class="details_field">Additional Rooms</p>
                                        <p class="details_value">1 Store Room</p>
                                    </div>
                                    <div class="details_class">
                                        <p class="details_field">Facing</p>
                                        <p class="details_value">North - East</p>
                                    </div>
                                    <div class="details_class">
                                        <p class="details_field">Lift</p>
                                        <p class="details_value">1</p>
                                    </div>
                                <!-- </div> -->
                                <!-- <div class="details_1"> -->
                                    <div class="details_class">
                                        <p class="details_field">Furnished Status</p>
                                        <p class="details_value">Semi furnished</p>
                                    </div>
                                    <div class="details_class">
                                        <p class="details_field">Type Of Ownership</p>
                                        <p class="details_value">Freehold</p>
                                    </div>
                                <!-- </div> -->
                                <!-- <div class="details_1"> -->
                                    <div class="details_class">
                                        <p class="details_field">Age Of Construction</p>
                                        <p class="details_value">5 to 10 Years</p>
                                    </div>
                                </div>
                                <div class="button_group">
                                    <button class="butt1">Download Brochure</button>
                                    <button class="butt2">Contact Owner</button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            <div class="image_loop">
                <template for:each={imagesOnDescription} for:item="propertyImage">
                    <div class="each_image" key={propertyImage.Id} data-id={propertyImage.Id} data-name={propertyImage.Name} data-url={propertyImage.FilenameUrlEncoded__c} onclick={previewAllImages}>
                        <img src={propertyImage.FilenameUrlEncoded__c} alt="Property">
                        <div class="black1" onclick={handleBoxClick}
                            data-id={propertyImage.Id}>
                            <div class="imgInfo">
                                <p>+{totalCountOfImg}</p>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <div class="box3">
            <div class="tab-container">

                <div class="div1">
                    <div class="tab-menu">
                        <ul>
                            <li><a class="active-tab" data-tab-id="tab1">Description</a></li>
                            <li><a data-tab-id="tab2">Gallery</a></li>
                        </ul>
                    </div>
                </div>
                <div class="tab active-tab-content" data-id="tab1">
                    <template for:each={propertyData} for:item="item">
                        <div class="about" key={item.Id}>
                            <h1><b>About this home</b></h1>
                            <p>
                                {item.Listing_Description__c}
                            </p>
                            <br />
                        </div>

                        <div class="facilities" key={item.Id}>
                            <h1><b>Facilities</b></h1>
                            <lightning-layout multiple-rows class="layout">
                                <template for:each={item.Property_Features__c} for:item="amenty">
                                    <lightning-layout-item padding="around-small" key={amenty}>
                                        <div
                                            class="custom-box slds-box slds-p-around_medium slds-text-align_center facilityBox">
                                            <img src={amenty.imgUrl} class="iconImg"></img>
                                            <br />
                                            <p>{amenty.name}</p>
                                        </div>
                                    </lightning-layout-item>
                                </template>
                            </lightning-layout>
                            <br />
                        </div>
                        
                        <div class="address" key={item.Id}>
                            <h1><b>Address</b></h1>
                            <div class="map_details">
                                <p class="map_d1">
                                    <svg width="16" height="19" viewBox="0 0 16 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M7.99967 10.2601C9.47243 10.2601 10.6663 9.09216 10.6663 7.65142C10.6663 6.21068 9.47243 5.04272 7.99967 5.04272C6.52692 5.04272 5.33301 6.21068 5.33301 7.65142C5.33301 9.09216 6.52692 10.2601 7.99967 10.2601Z" stroke="#2A2B3F" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M7.99978 0.694824C6.1138 0.694824 4.30506 1.42774 2.97147 2.73234C1.63788 4.03694 0.888672 5.80636 0.888672 7.65135C0.888672 9.29656 1.24601 10.3731 2.22201 11.5644L7.99978 18.0861L13.7776 11.5644C14.7536 10.3731 15.1109 9.29656 15.1109 7.65135C15.1109 5.80636 14.3617 4.03694 13.0281 2.73234C11.6945 1.42774 9.88577 0.694824 7.99978 0.694824Z" stroke="#2A2B3F" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg> &nbsp; {item.City__c},{item.State__c},{item.Postal_Code__c}
                                    </p>
                                    <p class="map_d2">View on Map</p>
                            </div>
                            <div class="map">
                                <lightning-map map-markers={mapMarkers}></lightning-map>
                            </div>
                        </div>
                    </template>
                </div>
                <div class="tab" data-id="tab2">
                    <div class="galleryFilterIcon">
                        <button class="galleryFilterIcon_btn active" onclick={applyFilter} data-name="galleryFilterIcon_all">All</button>
                        <button class="galleryFilterIcon_btn" onclick={applyFilter} data-name="galleryFilterIcon_room">Room</button>
                        <button class="galleryFilterIcon_btn" onclick={applyFilter} data-name="galleryFilterIcon_kitchen">Kitchen</button>
                    </div>

                    <div class="images_total"><p>Gallery <b>({totalImagesInGallery})</b></p></div>

                    <div class="PropertyImages">
                        <template for:each={propertyImages} for:item="propertyImage">
                            <div class="thumbnails" key={propertyImage.Id} data-id={propertyImage.Id} data-name={propertyImage.Name} data-url={propertyImage.FilenameUrlEncoded__c} onclick={previewAllImages}>
                                <img src={propertyImage.FilenameUrlEncoded__c} alt="Property">
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
        <!-- </template> -->
    </div>

    <template if:true={Show_ImagePreview}>
        <div class="slds-modal slds-fade-in-open image_preview" role="dialog"
            aria-modal="true">
            <div class="image_control_bar" onclick={stopEventPropagation}>
                <div class="image_title">
                    <lightning-icon icon-name="doctype:image" alternative-text="Image file" title="Image"
                        size="medium"></lightning-icon>
                    <h2>{PreviewImageTitle}</h2>
                </div>
                <div class="close_img" onclick={closeImagePreview}>
                    <lightning-icon icon-name="utility:close" alternative-text="close!" title="close"
                        size="small"></lightning-icon>
                </div>
            </div>
            <div class="img_preview_container">
                <template if:true={Is_ImageHavePreview}>
                    <img src={PreviewImageSrc} onload={handleImageLoaded} onerror={handleImageNotLoaded}
                        onclick={stopEventPropagation} />
                </template>
                <template if:true={PreviewImgSpinner}>
                    <div class="slds-spinner_container" style="position: absolute; background: #04040466;">
                        <div class="slds-spinner--brand slds-spinner slds-spinner--large slds-is-relative" role="alert">
                            <span class="slds-assistive-text">Loading</span>
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </template>
            </div>
            <div class="Next_Previous_btn">
                <template if:true={NotFirstImg}>
                    <div class="Previous_img_btn" onclick={changeImg} data-name="Previous_Image">
                        <lightning-icon icon-name="utility:chevronleft" title="Previous" size="small"></lightning-icon>
                    </div>
                </template>
                <template if:true={NotLastImg}>
                    <div class="Next_img_btn" onclick={changeImg} data-name="Next_Image">
                        <lightning-icon icon-name="utility:chevronright" title="Next" size="small"></lightning-icon>
                    </div>
                </template>
            </div>
        </div>
    </template>

</template>
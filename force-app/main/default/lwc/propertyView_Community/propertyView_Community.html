<template>
    <!-- <div class="backgroundImage"></div> -->
    <template if:true={spinnerdatatable}>
        <c-spinner-component></c-spinner-component>
    </template>
    <div class="main_BG">
        <img src={propertybg} alt="">
    </div>
    <div class="container">
        <div class="box1">
            <div class="carousel">
                <img src={propertyView} style="width:100%;height:80vh;" />
                <div if:true={errorMessage} class="black">
                    <h3>EstateXpert</h3>
                    <p>"404 Error: Data Not Found"</p>
                </div>
                <div if:false={errorMessage} class="buttons">
                    <div class="backbtn" onclick={moveToPropertyPage}>
                        <svg width="30" height="20" viewBox="0 0 30 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M30 10C30 10.3788 29.8025 10.7421 29.4509 11.01C29.0993 11.2778 28.6224 11.4283 28.1252 11.4283H6.40389L14.4542 17.5586C14.6285 17.6914 14.7668 17.8491 14.8612 18.0226C14.9555 18.1961 15.004 18.3821 15.004 18.5699C15.004 18.7577 14.9555 18.9437 14.8612 19.1172C14.7668 19.2907 14.6285 19.4483 14.4542 19.5811C14.2799 19.7139 14.073 19.8193 13.8452 19.8911C13.6175 19.963 13.3734 20 13.1269 20C12.8804 20 12.6363 19.963 12.4085 19.8911C12.1808 19.8193 11.9738 19.7139 11.7995 19.5811L0.55079 11.0112C0.376197 10.8786 0.237677 10.721 0.143163 10.5474C0.0486494 10.3739 0 10.1879 0 10C0 9.81213 0.0486494 9.6261 0.143163 9.45257C0.237677 9.27905 0.376197 9.12143 0.55079 8.98875L11.7995 0.418872C12.1516 0.150673 12.629 0 13.1269 0C13.6247 0 14.1022 0.150673 14.4542 0.418872C14.8063 0.687071 15.004 1.05083 15.004 1.43012C15.004 1.80941 14.8063 2.17317 14.4542 2.44137L6.40389 8.57169H28.1252C28.6224 8.57169 29.0993 8.72217 29.4509 8.99003C29.8025 9.25789 30 9.62119 30 10Z" fill="white"/>
                        </svg>                        
                    </div>
                    <div class="sharebtn">
                        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M24.1935 18.75C27.4065 18.75 30 21.2625 30 24.375C30 27.4875 27.4065 30 24.1935 30C20.9806 30 18.3871 27.4875 18.3871 24.375C18.3871 23.925 18.4452 23.5125 18.5613 23.0813L10.0839 18.7688C9.01935 19.9125 7.50968 20.625 5.80645 20.625C2.59355 20.625 0 18.1125 0 15C0 11.8875 2.59355 9.375 5.80645 9.375C7.50968 9.375 9.01935 10.1062 10.0839 11.2312L18.5613 6.91875C18.4452 6.4875 18.3871 6.075 18.3871 5.625C18.3871 2.5125 20.9806 0 24.1935 0C27.4065 0 30 2.5125 30 5.625C30 8.7375 27.4065 11.25 24.1935 11.25C22.4903 11.25 20.9806 10.5188 19.9161 9.39375L11.4387 13.7063C11.6731 14.5538 11.6731 15.4462 11.4387 16.2937L19.9161 20.6062C20.9806 19.4625 22.4903 18.75 24.1935 18.75Z" fill="white"/>
                        </svg>                        
                    </div>
                </div>
            </div>
        </div>

        <template if:false={errorMessage}>
            <div class="box2">
                <template for:each={propertyData} for:item="info">
                    <lightning-layout key={info.Id}>
                        <lightning-layout-item>
                            <div class="custom-box slds-box slds-p-around_medium detailBox info_Name">
                                <h1><b>{info.Name}</b></h1>
                                <p>{info.City__c},{info.State__c},{info.Postal_Code__c}</p>
                            </div>
                        </lightning-layout-item>
                        <lightning-layout-item alignment-bump="left">
                            <div class="custom-box slds-box slds-p-around_medium slds-text-align_center detailBox info_Price">
                                <p class="info_Price_tp"><b>Total Price</b></p>
                                <p class="info_Price_value"><b>$ {info.Listing_Price__c}</b></p>
                            </div>
                        </lightning-layout-item>
                        <lightning-layout-item>
                            <div class="custom-box slds-box slds-p-around_medium slds-text-align_center detailBox"
                                style="display: flex;justify-content:inline;">
                                <lightning-avatar slot="media" variant="circle"
                                    src="https://www.lightningdesignsystem.com/assets/images/avatar1.jpg"
                                    fallback-icon-name="standard:avatar" alternative-text="Bruce Wayne"></lightning-avatar>
                                <p style="margin-left: 1px;font-size:10px;margin-right:40px;"><b>Sandeep S.</b><br /><span
                                        style="color: #8C8C8C;">Partner</span></p>
                                <img src={EmailIcon} style="height:15px;width:18px;margin-right:12px;cursor:pointer"></img>
                                <img src={PhoneIcon} style="height:15px;width:18px;cursor:pointer"></img>
                            </div>
                        </lightning-layout-item>
                    </lightning-layout>
                </template>
            </div>

            <div class="box3">
                <div class="tab-container">

                    <div class="div1">
                        <div class="tab-menu">
                            <ul>
                                <li><a class="active-tab" data-tab-id="tab1">Description</a></li>
                                <li><a data-tab-id="tab2">Gallery</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="tab active-tab-content" data-id="tab1">
                        <template for:each={propertyData} for:item="item">
                            <div class="roomDetails" key={item.Id}>
                                <lightning-layout multiple-rows class="layout">
                                    <lightning-layout-item padding="around-small">
                                        <div
                                            class="custom-box slds-box slds-p-around_medium slds-text-align_center numberBox">
                                            <p>Bedrooms</p>
                                            <div class="numbers">
                                                <div class="imgicon">
                                                    <img src={BedroomIcon} class="iconImg"></img>
                                                </div>
                                                &nbsp;
                                                <div class="text">
                                                    <p><b>{item.Number_of_Bedrooms__c}</b></p>
                                                </div>
                                            </div>
                                        </div>
                                    </lightning-layout-item>
                                    <lightning-layout-item padding="around-small">
                                        <div
                                            class="custom-box slds-box slds-p-around_medium slds-text-align_center numberBox">
                                            <p>Bathrooms</p>
                                            <div class="numbers">
                                                <div class="imgicon">
                                                    <img src={BathroomIcon} class="iconImg"></img>
                                                </div>
                                                &nbsp;
                                                <div class="text">
                                                    <p><b>{item.Number_of_Bathrooms__c}</b></p>
                                                </div>
                                            </div>
                                        </div>
                                    </lightning-layout-item>
                                    <lightning-layout-item padding="around-small">
                                        <div
                                            class="custom-box slds-box slds-p-around_medium slds-text-align_center numberBox">
                                            <p>Size</p>
                                            <div class="numbers">
                                                <div class="imgicon">
                                                    <img src={BathroomSqftIcon} class="iconImg"></img>
                                                </div>
                                                &nbsp;
                                                <div class="text">
                                                    <p><b>{item.Sq_Ft__c}</b></p>
                                                </div>
                                            </div>
                                        </div>
                                    </lightning-layout-item>
                                </lightning-layout>
                                <br />
                            </div>

                            <div class="facilities" key={item.Id}>
                                <h1><b>Facilities</b></h1>
                                <lightning-layout multiple-rows class="layout">
                                    <template for:each={item.Property_Features__c} for:item="amenty">
                                        <lightning-layout-item padding="around-small" key={amenty}>
                                            <div
                                                class="custom-box slds-box slds-p-around_medium slds-text-align_center facilityBox">
                                                <img src={amenty.imgUrl} class="iconImg"></img>
                                                <br />
                                                <p>{amenty.name}</p>
                                            </div>
                                        </lightning-layout-item>
                                    </template>
                                </lightning-layout>
                                <br />
                            </div>
                            <div class="about" key={item.Id}>
                                <h1><b>About this home</b></h1>
                                <p>
                                    {item.Listing_Description__c}
                                </p>
                                <br />
                            </div>
                            <div class="address" key={item.Id}>
                                <h1><b>Address</b></h1>
                                <div class="map_details">
                                    <p class="map_d1">
                                        <svg width="16" height="19" viewBox="0 0 16 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.99967 10.2601C9.47243 10.2601 10.6663 9.09216 10.6663 7.65142C10.6663 6.21068 9.47243 5.04272 7.99967 5.04272C6.52692 5.04272 5.33301 6.21068 5.33301 7.65142C5.33301 9.09216 6.52692 10.2601 7.99967 10.2601Z" stroke="#2A2B3F" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M7.99978 0.694824C6.1138 0.694824 4.30506 1.42774 2.97147 2.73234C1.63788 4.03694 0.888672 5.80636 0.888672 7.65135C0.888672 9.29656 1.24601 10.3731 2.22201 11.5644L7.99978 18.0861L13.7776 11.5644C14.7536 10.3731 15.1109 9.29656 15.1109 7.65135C15.1109 5.80636 14.3617 4.03694 13.0281 2.73234C11.6945 1.42774 9.88577 0.694824 7.99978 0.694824Z" stroke="#2A2B3F" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg> &nbsp; {item.City__c},{item.State__c},{item.Postal_Code__c}
                                     </p>
                                     <p class="map_d2">View on Map</p>
                                </div>
                                <div class="map">
                                    <img src={map1} alt="">
                                </div>
                            </div>
                        </template>
                    </div>
                    <div class="tab" data-id="tab2">
                        <div class="galleryFilterIcon">
                            <button class="galleryFilterIcon_btn active" onclick={applyFilter} data-name="galleryFilterIcon_all">All</button>
                            <button class="galleryFilterIcon_btn" onclick={applyFilter} data-name="galleryFilterIcon_room">Room</button>
                            <button class="galleryFilterIcon_btn" onclick={applyFilter} data-name="galleryFilterIcon_kitchen">Kitchen</button>
                        </div>

                        <div class="images_total"><p>Gallery <b>({totalImagesInGallery})</b></p></div>

                        <div class="PropertyImages">
                            <template for:each={propertyImages} for:item="propertyImage">
                                <div class="thumbnails" key={propertyImage.Id} data-id={propertyImage.Id} data-name={propertyImage.Name} data-url={propertyImage.FilenameUrlEncoded__c} onclick={previewAllImages}>
                                    <img src={propertyImage.FilenameUrlEncoded__c} alt="Property">
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </div>

    <template if:true={Show_ImagePreview}>
        <!-- <div class="slds-backdrop slds-backdrop_open"></div> -->
        <div class="slds-modal slds-fade-in-open image_preview" role="dialog"
            aria-modal="true">
            <div class="image_control_bar" onclick={stopEventPropagation}>
                <div class="image_title">
                    <lightning-icon icon-name="doctype:image" alternative-text="Image file" title="Image"
                        size="medium"></lightning-icon>
                    <h2>{PreviewImageTitle}</h2>
                </div>
                <div class="close_img" onclick={closeImagePreview}>
                    <lightning-icon icon-name="utility:close" alternative-text="close!" title="close"
                        size="small"></lightning-icon>
                </div>
            </div>
            <div class="img_preview_container">
                <template if:true={Is_ImageHavePreview}>
                    <img src={PreviewImageSrc} onload={handleImageLoaded} onerror={handleImageNotLoaded}
                        onclick={stopEventPropagation} />
                </template>
                <template if:true={PreviewImgSpinner}>
                    <div class="slds-spinner_container" style="position: absolute; background: #04040466;">
                        <div class="slds-spinner--brand slds-spinner slds-spinner--large slds-is-relative" role="alert">
                            <span class="slds-assistive-text">Loading</span>
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </template>
            </div>
            <div class="Next_Previous_btn">
                <template if:true={NotFirstImg}>
                    <div class="Previous_img_btn" onclick={changeImg} data-name="Previous_Image">
                        <lightning-icon icon-name="utility:chevronleft" title="Previous" size="small"></lightning-icon>
                    </div>
                </template>
                <template if:true={NotLastImg}>
                    <div class="Next_img_btn" onclick={changeImg} data-name="Next_Image">
                        <lightning-icon icon-name="utility:chevronright" title="Next" size="small"></lightning-icon>
                    </div>
                </template>
            </div>
        </div>
    </template>

</template>